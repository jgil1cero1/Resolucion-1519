(function(a){a.frTTSEngine=function(d){var i;var C;var b;var n;var h;var k;var x;var f;var l;var c;var t=new Array();var s=null;var z=0;var y={"en-US":"US English Female","en-AU":"Australian Female","en-GB":"UK English Female",en:"UK English Female","es-ES":"Spanish Female",es:"Spanish Female","et-EE":"Estonian Male",et:"Estonian Male","fr-FR":"French Female",fr:"French Female","de-DE":"Deutsch Female",de:"Deutsch Female","it-IT":"Italian Female",it:"Italian Female","el-GR":"Greek Female",el:"Greek Female","hu-HU":"Hungarian Female",hu:"Hungarian Female","tr-TR":"Turkish Female",tr:"Turkish Female","ru-RU":"Russian Female",ru:"Russian Female","nl-BE":"Dutch Female","nl-NL":"Dutch Female",nl:"Dutch Female","sv-FI":"Swedish Female","sv-SE":"Swedish Female",sv:"Swedish Female","nb-NO":"Norwegian Female",nb:"Norwegian Female",no:"Norwegian Female","ja-JP":"Japanese Female",ja:"Japanese Female","ko-KR":"Korean Female",ko:"Korean Female","zh-CN":"Chinese Female","zh-HK":"Chinese Female","zh-MO":"Chinese Female","zh-SG":"Chinese Female","zh-TW":"Chinese Female",zh:"Chinese Female","hi-IN":"Hindi Female",hi:"Hindi Female","sr-BA":"Serbian Male","sr-SP":"Serbian Male",sr:"Serbian Male","hr-BA":"Croatian Male","hr-HR":"Croatian Male",hr:"Croatian Male","bs-BA":"Bosnian Male",bs:"Bosnian Male","ro-RO":"Romanian Female",ro:"Romanian Female","ca-ES":"Catalan Male",ca:"Catalan Male","fi-FI":"Finnish Female",fi:"Finnish Female","af-ZA":"Afrikaans Male",af:"Afrikaans Male","sq-AL":"Albanian Male",sq:"Albanian Male","ar-AR":"Arabic Male","ar-AE":"Arabic Male","ar-AA":"Arabic Male",ar:"Arabic Male","hy-AM":"Armenian Male",hy:"Armenian Male","cs-CZ":"Czech Female",cs:"Czech Female","da-DK":"Danish Female",da:"Danish Female",eo:"Esperanto Male","is-IS":"Icelandic Male",is:"Icelandic Male","id-ID":"Indonesian Female",id:"Indonesian Female","lv-LV":"Latvian Male",lv:"Latvian Male","mk-MK":"Macedonian Male",mk:"Macedonian Male",md:"Moldavian Female","fil-PH":"Filipino Female","pl-PL":"Polish Female",pl:"Polish Female","pt-BR":"Brazilian Portuguese Female","pt-PT":"Portuguese Female",pt:"Portuguese Female","sk-SK":"Slovak Female",sk:"Slovak Female","sw-KE":"Swahili Male",sw:"Swahili Male","ta-IN":"Tamil Male",ta:"Tamil Male","th-TH":"Thai Female",th:"Thai Female","vi-VN":"Vietnamese Male",vi:"Vietnamese Male","cy-GB":"Welsh Male",cy:"Welsh Male"};function e(G){h=0;k=B(h+x);var F=n.substring(h,k);if(F.length){soundManager.createSound({id:"chunkSound",url:c.baseURI+"plugins/system/screenreader/screenreader/libraries/tts/"+c.readerEngine+".php?lang="+f+"&voicespeed="+c.screenReaderVoiceSpeed+"&token="+c.token+"&text="+encodeURIComponent(F),autoLoad:false,type:"audio/mp3"});soundManager.play("chunkSound",{onfinish:function(){soundManager.destroySound("chunkSound");if(t.length){if(c.preload){m(t)}else{p(t)}}else{g("finished");return}}});s="chunkSound";soundManager.setVolume(s,c.screenReaderVolume)}else{g("notext");return}if(n.substr(k)&&c.preload){var E=0;var D=function(){h=k;k=B(h+x);G=n.substring(h,k);var H=soundManager.createSound({id:"chunkSound"+E,url:c.baseURI+"plugins/system/screenreader/screenreader/libraries/tts/"+c.readerEngine+".php?lang="+f+"&voicespeed="+c.screenReaderVoiceSpeed+"&token="+c.token+"&text="+encodeURIComponent(G),autoLoad:false,type:"audio/mp3"});H.load();t.push(H);E++;if(n.substr(k)){b=setTimeout(function(){if(C!=="stop"){D()}},3000)}};b=setTimeout(function(){if(C!=="stop"){D()}},3000)}else{if(n.substr(k)){var E=0;while(n.substr(k)){h=k;k=B(h+x);G=n.substring(h,k);t.push(G);E++}}}}function m(E){var D=E.splice(0,1);if(a.isArray(D)&&D.length){soundManager.play(D[0]["id"],{onfinish:function(){soundManager.destroySound(D[0]["id"]);m(E)}});s=D[0]["id"];soundManager.setVolume(s,c.screenReaderVolume)}else{g("finished");return}}function p(G){var E=G.splice(0,1);var D="chunkSound"+z;if(a.isArray(E)&&E.length){var F=soundManager.createSound({id:D,url:c.baseURI+"plugins/system/screenreader/screenreader/libraries/tts/"+c.readerEngine+".php?lang="+f+"&voicespeed="+c.screenReaderVoiceSpeed+"&token="+c.token+"&text="+encodeURIComponent(E[0]),autoLoad:false,type:"audio/mp3"});soundManager.play(D,{onfinish:function(){soundManager.destroySound(D);p(G)}});s=D;soundManager.setVolume(s,c.screenReaderVolume);z++}else{g("finished");return}}function j(){soundManager.stopAll();soundManager.destroySound("chunkSound");a.each(soundManager.sounds,function(D,E){soundManager.destroySound(E.id)});t=new Array();s=null}function B(F){if(n.charAt(F)==" "){return F}var E=n.substr(F);if(E.indexOf(" ")==-1){var D=E.length+F;return D}else{var G=E.indexOf(" ")+F;return G}}function r(){var D=a("#volume_plugin");var I=c.screenReaderVolume/20;var F=5;for(var E=0;E<F;E++){var H=!!(E<I)?" active":"";var G=c.volume_accesskeys?'accesskey="'+(E+1)+'"':"";a(D).append('<div id="volume_step'+(E+1)+'" class="volume_step'+H+'" data-value="'+parseInt((E+1)*20)+'"'+G+"></div>")}}function A(D){var E="";var F=a(D).find("img");a.each(F,function(H,I){var G=a(I).attr(c.readImagesAttribute);if(G){E+=G+". "}});return E}function q(K,H,I,J){var L="";if(window.getSelection){L=window.getSelection().toString()}else{if(document.selection&&document.selection.type!="Control"){L=document.selection.createRange().text}}if(H){var F=a(K).parent();L=F.clone().children(".screenreader_embed_play_button").remove().end().find("script, noscript, style").remove().end().text();if(c.readImages){var D=A(F);if(c.readImagesOrdering=="before"){L=D+L}else{L=L+". "+D}}a("span.screenreader_embed_stop_button").toggleClass("screenreader_embed_stop_button screenreader_embed_play_button");a(K).toggleClass("screenreader_embed_play_button screenreader_embed_stop_button");a(F).selectText()}if(c.readImagesHovering&&I){var G=a(I).attr(c.readImagesAttribute);L=G;if(!L){return""}}if(c.readElementsHovering&&J){L=a(J).clone().children(".screenreader_embed_play_button").remove().end().find("script, noscript, style").remove().end().text();a(J).selectText()}if(!!c.readPage&&!L){if(!!c.readChildNodes){if(c.excludeScripts){var E=a(c.mainpageSelector).clone().find("script, noscript, style, .screenreader_embed_play_button").remove().end().filter(function(){if(this.nodeName&&(this.nodeName.toLowerCase()=="script"||this.nodeName.toLowerCase()=="noscript"||this.nodeName.toLowerCase()=="style")){return false}return true});L=a.trim(a(E).text())}else{L=a.trim(a(c.mainpageSelector).text())}if(c.selectMainpageareaText){a(c.mainpageSelector).selectText()}if(c.readImages){var D=A(E);if(c.readImagesOrdering=="before"){L=D+L}else{L=L+". "+D}}}else{L=a.trim(a(c.mainpageSelector).immediateText())}}L=L.replace(/[\n\r\t]/g," ");L=L.replace(/\s+/g," ");L=L.replace(/\s\./g,".");return L}function w(F){var E=F+"=";var D=document.cookie.split(";");for(var G=0;G<D.length;G++){var H=D[G];while(H.charAt(0)==" "){H=H.substring(1)}if(H.indexOf(E)==0){return H.substring(E.length,H.length)}}return false}function u(){if(c.readerEngine=="proxy_responsive"){if(f in y){f=y[f];responsiveVoice.setDefaultVoice(f)}}}function g(D){switch(D){case"playing":a("div#tts_message").remove();if(c.templateOrientation=="vertical"&&(c.position=="topright"||c.position=="topleft")){a("<div/>").attr("id","tts_message").css("background-color",c.toolbarBgcolor).appendTo("#accessibility-links").append('<div id="playicon"></div>')}else{a("<div/>").attr("id","tts_message").css("background-color",c.toolbarBgcolor).prependTo("#accessibility-links").append('<div id="playicon"></div>')}a("#playicon").css("background-color",c.toolbarBgcolor);break;case"paused":a("div#tts_message").remove();if(c.templateOrientation=="vertical"&&(c.position=="topright"||c.position=="topleft")){a("<div/>").attr("id","tts_message").css("background-color",c.toolbarBgcolor).appendTo("#accessibility-links").append('<div id="msgtext">'+fr_paused+"</div>")}else{a("<div/>").attr("id","tts_message").css("background-color",c.toolbarBgcolor).prependTo("#accessibility-links").append('<div id="msgtext">'+fr_paused+"</div>")}break;case"finished":s=null;a("div#tts_message").fadeOut(500,function(){a(this).remove()});a("span.screenreader_embed_stop_button").toggleClass("screenreader_embed_stop_button screenreader_embed_play_button");a(document).unselectText();break;case"notext":a("div#tts_message").remove();if(c.templateOrientation=="vertical"&&(c.position=="topright"||c.position=="topleft")){a("<div/>").attr("id","tts_message").css("background-color",c.toolbarBgcolor).appendTo("#accessibility-links").append('<div id="msgtext">'+fr_notext+"</div>").delay(1500).fadeOut(500,function(){a(this).remove()})}else{a("<div/>").attr("id","tts_message").css("background-color",c.toolbarBgcolor).prependTo("#accessibility-links").append('<div id="msgtext">'+fr_notext+"</div>").delay(1500).fadeOut(500,function(){a(this).remove()})}break}}function o(){a(document).on("click.frTTS","#fr_screenreader_play, span.screenreader_embed_play_button",function(E,F,H){i=true;C="play";clearTimeout(b);var D=!!a(this).hasClass("screenreader_embed_play_button");n=q(this,D,F,H);if(!n.length){g("notext")}else{j();if(c.readerEngine=="proxy_responsive"){var G={veryslow:0.7,slow:0.8,normal:0.9,fast:1,veryfast:1.1};responsiveVoice.speak(n,f,{volume:(c.screenReaderVolume/100),rate:G[c.screenReaderVoiceSpeed],onend:function(){g("finished")}})}else{e()}g("playing")}a("#fr_screenreader_pause").removeClass("active");E.stopPropagation();E.preventDefault()});a(document).on("click.frTTS","#fr_screenreader_pause",function(D){if(c.readerEngine!="proxy_responsive"&&!s){return}if(c.readerEngine=="proxy_responsive"&&!responsiveVoice.isPlaying()){return}switch(i){case true:i=false;C="pause";if(c.readerEngine=="proxy_responsive"){responsiveVoice.pause();responsiveVoice.nativePaused=true}else{soundManager.pause(s)}g("paused");a(this).addClass("active");break;case false:i=true;C="play";if(c.readerEngine=="proxy_responsive"){responsiveVoice.resume();responsiveVoice.nativePaused=false}else{soundManager.resume(s)}g("playing");a(this).removeClass("active");break}});a(document).on("click.frTTS","#fr_screenreader_stop, span.screenreader_embed_stop_button",function(E){i=false;C="stop";clearTimeout(b);a("#fr_screenreader_pause").removeClass("active");if(c.readerEngine=="proxy_responsive"){responsiveVoice.cancel()}else{j()}var D=!!a(this).hasClass("screenreader_embed_stop_button");if(D){a(this).toggleClass("screenreader_embed_stop_button screenreader_embed_play_button");a(this).parent().unselectText()}g("finished")});if(c.readImagesHovering){a(document).on("pointerenter.frTTS","img",function(D){a("#fr_screenreader_play").trigger("click.frTTS",this)})}if(c.readElementsHovering){a("body").on("pointerdown.frTTS",function(D){if(D.clientX){a(document).on("pointerenter.frTTS",c.elementsHoveringSelector,function(E){a("#fr_screenreader_play").trigger("click.frTTS",[false,this])});a(document).on("pointerleave.frTTS",c.elementsHoveringSelector,function(E){a("#fr_screenreader_stop").trigger("click.frTTS")});a("body").off("pointerdown.frTTS")}})}a(document).on("click.frTTS","div.volume_step",function(D){a(this).siblings("div").removeClass("active");a(this).prevAll("div").addClass("active");a(this).addClass("active");soundManager.setVolume(s,parseInt(a(this).attr("data-value")));c.screenReaderVolume=a(this).attr("data-value")});if(c.gtranslateIntegration){a('select[onchange*="GTranslate"]').on("change",function(E){var F=a(this).val();if(F){var D=F.split("|");f=D[1];u()}});a('a[onclick*="GTranslate"]').on("click",function(D){setTimeout(function(){if(w("googtrans")){var E=w("googtrans").split("/");if(E[2]){f=E[2];u()}}else{f=l;u()}},500)})}}(function v(){a.fn.extend({immediateText:function(){return this.clone().find("*").remove().end().text()}});a.fn.extend({selectText:function(){a("span[class*=screenreader_embed_]").css("font-size",0);var L=document;var J=this[0];if(J){if(L.body.createTextRange){var I=document.body.createTextRange();I.moveToElementText(J);I.select()}else{if(window.getSelection){var K=window.getSelection();var I=document.createRange();I.selectNodeContents(J);K.removeAllRanges();K.addRange(I)}}}},unselectText:function(){a("span[class*=screenreader_embed_]").css("font-size","inherit");var I=window.getSelection?window.getSelection():document.selection?document.selection:null;if(!!I){I.empty?I.empty():I.removeAllRanges()}}});var F=this;i=false;C="stop";var D={baseURI:null,toolbarBgcolor:"#EEE",token:null,langCode:"en",chunkLength:80,screenReaderVolume:80,screenReaderVoiceSpeed:"normal",preload:0,readPage:1,readChildNodes:1,excludeScripts:1,readImages:0,readImagesAttribute:"alt",readImagesOrdering:"before",mainpageSelector:"*[name*=main], *[class*=main], *[id*=main], *[id*=container], *[class*=container]",readerEngine:"proxy_virtual",gtranslateIntegration:0,selectMainpageareaText:0,volume_accesskeys:1,readElementsHovering:0,elementsHoveringSelector:"p"};c=a.extend({},D,d);var G=new Image();G.src=c.baseURI+"plugins/system/screenreader/screenreader/libraries/controller/css/images/waves.gif";f=c.langCode;l=f;if(c.gtranslateIntegration&&w("googtrans")){var E=w("googtrans").split("/");if(E[2]){f=E[2]}}if(c.gtranslateIntegration&&!w("googtrans")){var E=a("html").attr("lang").split("-");if(E[0]){f=E[0]}}if(c.readerEngine=="proxy_responsive"){if(f in y){f=y[f];responsiveVoice.setDefaultVoice(f)}}x=c.chunkLength;var H=function(){var K=!!("ontouchstart" in window);var I=!!(navigator.msMaxTouchPoints);var J=K||I;return J};if(H()){c.preload=0}r();if(c.template=="custom.css"){a("#volume_plugin").css("background",c.toolbarBgcolor)}o()}).call(this);this.getState=function(){return i}}})(jQuery);